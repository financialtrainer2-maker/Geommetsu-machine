<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì ë©”ì¶” - ë‹¤ì–‘í•œ ë©”ë‰´ ë¡¤ë ›</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; min-height:100vh; background: linear-gradient(135deg, #ffecd2, #fcb69f); display:flex; flex-direction: column; align-items:center; }
.filter-card, .main-card { background:#fff; border-radius:15px; padding:20px; width:90%; max-width:450px; margin:20px 0; box-shadow:0 10px 25px rgba(0,0,0,0.2); }
.filter-card h3, .main-card h1 { margin-bottom:10px; text-align:center; }
.filter-card label { display:flex; align-items:center; gap:8px; font-size:16px; cursor:pointer; margin-bottom:5px; }
.filter-card input[type=radio] { width:20px; height:20px; }
button { padding:12px; font-size:18px; border-radius:10px; border:none; cursor:pointer; width:100%; margin-top:10px; }
.recommend-btn { background-color:#ff7f50; color:white; }
.share-result-btn { background-color:#4CAF50; color:white; }
.share-web-btn { background-color:#2196F3; color:white; }
.sns-buttons { display:flex; gap:10px; margin-top:10px; justify-content:center; flex-wrap:wrap; }
.result { margin-top:20px; font-size:16px; text-align:left; width:100%; max-height:350px; overflow-y:auto; padding-right:5px; }
.advantages, .disadvantages { margin-top:10px; padding:10px; background:#f9f9f9; border-radius:10px; }
.advantages strong, .disadvantages strong { color:#ff7f50; }
.roulette { font-size:22px; font-weight:bold; margin-top:20px; min-height:28px; transition: all 0.2s; text-align:center; }
.roulette.spin { animation: spinFlash 0.2s; }
.roulette.final { color:#fff; background:#ff7f50; border-radius:10px; padding:5px; }
@keyframes spinFlash {
  0% { color:#000; background:transparent; }
  50% { color:#ff7f50; background:#fff3e0; transform: scale(1.2); }
  100% { color:#000; background:transparent; transform: scale(1); }
}
.adsense { background-color:#f1f1f1; width:90%; max-width:450px; height:90px; margin:20px 0; display:flex; justify-content:center; align-items:center; color:#888; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.2);}
.rating { display:flex; gap:5px; margin:10px 0; justify-content:center; }
.star { font-size:24px; cursor:pointer; color:#ddd; transition:color 0.2s; }
.star.active { color:#ffd700; }
.rating-text { text-align:center; margin-top:5px; font-size:14px; color:#666; }
.favorite-btn { background-color:#ff69b4; color:white; margin-top:10px; }
.leaderboard { background:#fff; border-radius:15px; padding:20px; width:90%; max-width:450px; margin:20px 0; box-shadow:0 10px 25px rgba(0,0,0,0.2); }
.leaderboard h3 { text-align:center; margin-bottom:15px; }
.leaderboard-item { display:flex; justify-content:space-between; align-items:center; padding:8px 0; border-bottom:1px solid #eee; }
.leaderboard-item:last-child { border-bottom:none; }
.rank { font-weight:bold; color:#ff7f50; }
.daily-challenge { background:#fff; border-radius:15px; padding:20px; width:90%; max-width:450px; margin:20px 0; box-shadow:0 10px 25px rgba(0,0,0,0.2); text-align:center; }
.challenge-btn { background-color:#9c27b0; color:white; }
</style>
</head>
<body>

<div class="adsense">ê´‘ê³  ìë¦¬ (AdSense ì‚½ì…)</div>

<div class="daily-challenge">
  <h3>ğŸ¯ ì˜¤ëŠ˜ì˜ ì±Œë¦°ì§€</h3>
  <p id="challengeText">ìƒˆë¡œìš´ ë©”ë‰´ì— ë„ì „í•´ë³´ì„¸ìš”!</p>
  <button class="challenge-btn" onclick="startDailyChallenge()">ì±Œë¦°ì§€ ì‹œì‘</button>
</div>

<div class="leaderboard">
  <h3>ğŸ† ì¸ê¸° ë©”ë‰´ TOP 5</h3>
  <div id="leaderboardList">
    <div class="leaderboard-item">
      <span class="rank">1ìœ„</span>
      <span>ê¹€ì¹˜ì°Œê°œ ğŸ²</span>
      <span>â­ 4.8</span>
    </div>
    <div class="leaderboard-item">
      <span class="rank">2ìœ„</span>
      <span>ë¹„ë¹”ë°¥ ğŸ¥—</span>
      <span>â­ 4.7</span>
    </div>
    <div class="leaderboard-item">
      <span class="rank">3ìœ„</span>
      <span>ì´ˆë°¥ ğŸ£</span>
      <span>â­ 4.6</span>
    </div>
    <div class="leaderboard-item">
      <span class="rank">4ìœ„</span>
      <span>ìŠ¤í…Œì´í¬ ğŸ¥©</span>
      <span>â­ 4.5</span>
    </div>
    <div class="leaderboard-item">
      <span class="rank">5ìœ„</span>
      <span>íŒŒìŠ¤íƒ€ ğŸ</span>
      <span>â­ 4.4</span>
    </div>
  </div>
</div>

<div class="filter-card">
  <h3>ì¹´í…Œê³ ë¦¬/ë§› í•„í„° (í•œ ë²ˆì— í•˜ë‚˜ ì„ íƒ)</h3>
  <label><input type="radio" name="filter" value="í•œì‹"> í•œì‹</label>
  <label><input type="radio" name="filter" value="ì–‘ì‹"> ì–‘ì‹</label>
  <label><input type="radio" name="filter" value="ì¤‘ì‹"> ì¤‘ì‹</label>
  <label><input type="radio" name="filter" value="ì¼ì‹"> ì¼ì‹</label>
  <label><input type="radio" name="filter" value="ê°„ë‹¨"> ê°„ë‹¨</label>
  <label><input type="radio" name="filter" value="ê±´ê°•ì‹"> ê±´ê°•ì‹</label>
  <label><input type="radio" name="filter" value="ë§¤ìš´ë§›"> ë§¤ìš´ ë§›</label>
  <label><input type="radio" name="filter" value="ì‹œì›í•œë§›"> ì‹œì›í•œ ë§›</label>
  <label><input type="radio" name="filter" value="ìˆœí•œë§›"> ìˆœí•œ ë§›</label>
</div>

<div class="main-card">
  <h1>ì ë©”ì¶” ğŸ½</h1>
  <button class="recommend-btn" onclick="startRoulette()">ì¶”ì²œ!</button>
  <div class="roulette" id="roulette">ğŸ½</div>
  <div class="result" id="result"></div>
  <div class="rating" id="rating" style="display:none;">
    <span class="star" onclick="rateMenu(1)">â­</span>
    <span class="star" onclick="rateMenu(2)">â­</span>
    <span class="star" onclick="rateMenu(3)">â­</span>
    <span class="star" onclick="rateMenu(4)">â­</span>
    <span class="star" onclick="rateMenu(5)">â­</span>
  </div>
  <div class="rating-text" id="ratingText" style="display:none;"></div>
  <button class="favorite-btn" id="favoriteBtn" style="display:none;" onclick="toggleFavorite()">â¤ï¸ ì¦ê²¨ì°¾ê¸°</button>
  <button class="share-result-btn" id="shareResultBtn" style="display:none;" onclick="shareResult(true)">ê²°ê³¼ ê³µìœ </button>
  <button class="share-web-btn" onclick="shareResult(false)">ì›¹ ê³µìœ </button>
  <button class="share-web-btn" id="findRestaurantBtn" style="display:none; background-color:#ff9800;" onclick="findNearbyRestaurants()">ğŸª ê·¼ì²˜ ë§›ì§‘ ì°¾ê¸°</button>

  <div class="sns-buttons" id="snsButtons" style="display:none;">
    <a id="kakaoBtn" href="#" target="_blank" style="background:#FEE500; color:#000; padding:8px 12px; border-radius:8px; text-decoration:none; font-size:14px;">ì¹´ì¹´ì˜¤í†¡</a>
    <a id="facebookBtn" href="#" target="_blank" style="background:#1877F2; color:#fff; padding:8px 12px; border-radius:8px; text-decoration:none; font-size:14px;">í˜ì´ìŠ¤ë¶</a>
    <a id="twitterBtn" href="#" target="_blank" style="background:#1DA1F2; color:#fff; padding:8px 12px; border-radius:8px; text-decoration:none; font-size:14px;">íŠ¸ìœ„í„°</a>
  </div>
</div>

<script>
// ë©”ë‰´ ë°ì´í„° (20ê°œ ì´ìƒ)
const menus = [
  {name:"ê¹€ì¹˜ì°Œê°œ ğŸ²", health:"ë©´ì—­ë ¥ ê°•í™”", ingredients:["ê¹€ì¹˜","ë¼ì§€ê³ ê¸°","ë‘ë¶€"], advantages:"ë”°ëœ»í•¨, ì†Œí™” ë„ì›€", disadvantages:"ì¹¼ë¡œë¦¬ ë†’ìŒ", tags:["í•œì‹","ë§¤ìš´ë§›"]},
  {name:"ë¹„ë¹”ë°¥ ğŸ¥—", health:"ì˜ì–‘ ê· í˜•", ingredients:["ë°¥","ë‚˜ë¬¼","ê³„ë€"], advantages:"ë¹„íƒ€ë¯¼ í’ë¶€", disadvantages:"ì¡°ë¦¬ì‹œê°„ ìˆìŒ", tags:["í•œì‹","ê±´ê°•ì‹","ìˆœí•œë§›"]},
  {name:"í”¼ì ğŸ•", health:"ì¹¼ìŠ˜ ê³µê¸‰", ingredients:["ë„ìš°","ì¹˜ì¦ˆ","í† ë§ˆí†  ì†ŒìŠ¤"], advantages:"ë§›ìˆìŒ", disadvantages:"ì¹¼ë¡œë¦¬ ë†’ìŒ", tags:["ì–‘ì‹","ê°„ë‹¨"]},
  {name:"ë¼ë©´ ğŸœ", health:"ë¹ ë¥¸ ì—ë„ˆì§€", ingredients:["ë¼ë©´","ê³„ë€","ê¹€ì¹˜"], advantages:"ë¹ ë¥¸ ì¡°ë¦¬", disadvantages:"ë‚˜íŠ¸ë¥¨ ë†’ìŒ", tags:["ê°„ë‹¨","ë§¤ìš´ë§›"]},
  {name:"ìƒëŸ¬ë“œ ğŸ¥—", health:"ë¹„íƒ€ë¯¼ í’ë¶€", ingredients:["ì±„ì†Œ","ë“œë ˆì‹±"], advantages:"ë‹¤ì´ì–´íŠ¸ ë„ì›€", disadvantages:"í¬ë§Œê° ì ìŒ", tags:["ê±´ê°•ì‹","ê°„ë‹¨","ìˆœí•œë§›"]},
  {name:"ë–¡ë³¶ì´ ğŸŒ¶", health:"ì¹¼ë¡œë¦¬ ê³µê¸‰", ingredients:["ë–¡","ê³ ì¶”ì¥"], advantages:"ê¸°ë¶„ ì „í™˜", disadvantages:"ë§¤ìš´ë§› ê°•í•¨", tags:["í•œì‹","ë§¤ìš´ë§›","ê°„ë‹¨"]},
  {name:"ì´ˆë°¥ ğŸ£", health:"ë‹¨ë°±ì§ˆ ê³µê¸‰", ingredients:["ë°¥","ìƒì„ "], advantages:"ì˜¤ë©”ê°€3 í’ë¶€", disadvantages:"ì¡°ë¦¬ ì–´ë ¤ì›€", tags:["ì¼ì‹","ìˆœí•œë§›"]},
  {name:"íŒŒìŠ¤íƒ€ ğŸ", health:"íƒ„ìˆ˜í™”ë¬¼ ê³µê¸‰", ingredients:["íŒŒìŠ¤íƒ€","ì†ŒìŠ¤"], advantages:"ê°„í¸", disadvantages:"ì¹¼ë¡œë¦¬ ë†’ìŒ", tags:["ì–‘ì‹","ê°„ë‹¨"]},
  {name:"ìŠ¤í…Œì´í¬ ğŸ¥©", health:"ë‹¨ë°±ì§ˆ, ì² ë¶„", ingredients:["ì†Œê³ ê¸°","ì†Œê¸ˆ"], advantages:"ì˜ì–‘ í’ë¶€", disadvantages:"ì¡°ë¦¬ ë‚œì´ë„ ìˆìŒ", tags:["ì–‘ì‹","ê±´ê°•ì‹"]},
  {name:"ìƒŒë“œìœ„ì¹˜ ğŸ¥ª", health:"ê°„ë‹¨í•œ ì‹ì‚¬", ingredients:["ë¹µ","í–„","ì¹˜ì¦ˆ"], advantages:"ë¹ ë¥¸ ì¡°ë¦¬", disadvantages:"ì˜ì–‘ ë¶ˆê· í˜•", tags:["ì–‘ì‹","ê°„ë‹¨"]},
  {name:"ìš°ë™ ğŸœ", health:"ì†Œí™” ë„ì›€", ingredients:["ë©´","êµ­ë¬¼"], advantages:"ë”°ëœ»í•¨", disadvantages:"ì¹¼ë¡œë¦¬ ìˆìŒ", tags:["ì¼ì‹","ìˆœí•œë§›"]},
  {name:"ì§œì¥ë©´ ğŸœ", health:"íƒ„ìˆ˜í™”ë¬¼ ê³µê¸‰", ingredients:["ë©´","ì§œì¥ ì†ŒìŠ¤"], advantages:"ë§›ìˆìŒ", disadvantages:"ì¹¼ë¡œë¦¬ ë†’ìŒ", tags:["ì¤‘ì‹","ìˆœí•œë§›"]},
  {name:"íƒ•ìˆ˜ìœ¡ ğŸ¥©", health:"ë‹¨ë°±ì§ˆ ê³µê¸‰", ingredients:["ë¼ì§€ê³ ê¸°","ì†ŒìŠ¤"], advantages:"ë§›ìˆìŒ", disadvantages:"ì¹¼ë¡œë¦¬ ë†’ìŒ", tags:["ì¤‘ì‹","ê°„ë‹¨"]},
  {name:"ê¹€ë°¥ ğŸ™", health:"ê°„í¸ ì‹ì‚¬", ingredients:["ë°¥","ì¬ë£Œ"], advantages:"íœ´ëŒ€ ê°„í¸", disadvantages:"ì¹¼ë¡œë¦¬ ìˆìŒ", tags:["í•œì‹","ê°„ë‹¨"]},
  {name:"ì˜¤ë¯€ë¼ì´ìŠ¤ ğŸ³", health:"ë‹¨ë°±ì§ˆ ê³µê¸‰", ingredients:["ë°¥","ê³„ë€"], advantages:"ë§›ìˆìŒ", disadvantages:"ì¡°ë¦¬ ì‹œê°„", tags:["ì–‘ì‹","ìˆœí•œë§›"]},
  {name:"ì¹´ë ˆ ğŸ›", health:"íƒ„ìˆ˜í™”ë¬¼ ê³µê¸‰", ingredients:["ë°¥","ì¹´ë ˆ ì†ŒìŠ¤"], advantages:"ê°„í¸", disadvantages:"ì¹¼ë¡œë¦¬ ìˆìŒ", tags:["ì–‘ì‹","ìˆœí•œë§›"]},
  {name:"ëƒ‰ë©´ ğŸ¥¢", health:"ì‹œì›í•¨", ingredients:["ë©´","ìœ¡ìˆ˜"], advantages:"ì—¬ë¦„ì— ì¢‹ìŒ", disadvantages:"í¬ë§Œê° ì ìŒ", tags:["í•œì‹","ì‹œì›í•œë§›"]},
  {name:"ê°ˆë¹„íƒ• ğŸ²", health:"ë‹¨ë°±ì§ˆ ê³µê¸‰", ingredients:["ê°ˆë¹„","ìœ¡ìˆ˜"], advantages:"ì˜ì–‘ í’ë¶€", disadvantages:"ì¡°ë¦¬ ì‹œê°„", tags:["í•œì‹","ìˆœí•œë§›"]},
  {name:"ë¶€ëŒ€ì°Œê°œ ğŸ²", health:"ì¹¼ë¡œë¦¬ ê³µê¸‰", ingredients:["í–„","ì†Œì‹œì§€","ê¹€ì¹˜"], advantages:"í¬ë§Œê°", disadvantages:"ë‚˜íŠ¸ë¥¨ ë†’ìŒ", tags:["í•œì‹","ë§¤ìš´ë§›"]},
  {name:"ë–¡êµ­ ğŸ²", health:"íƒ„ìˆ˜í™”ë¬¼ ê³µê¸‰", ingredients:["ë–¡","ìœ¡ìˆ˜"], advantages:"ìƒˆí•´ì— ì¢‹ìŒ", disadvantages:"ì¡°ë¦¬ ì‹œê°„", tags:["í•œì‹","ìˆœí•œë§›"]}
];

let finalMenu = null;
let userRatings = JSON.parse(localStorage.getItem('menuRatings') || '{}');
let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
let dailyChallenge = JSON.parse(localStorage.getItem('dailyChallenge') || '{}');

// ì¼ì¼ ì±Œë¦°ì§€ ì´ˆê¸°í™”
function initDailyChallenge() {
  const today = new Date().toDateString();
  if (!dailyChallenge.date || dailyChallenge.date !== today) {
    const challenges = [
      "í•œì‹ì„ ë¨¹ì–´ë³´ì„¸ìš”!",
      "ìƒˆë¡œìš´ ì–‘ì‹ì— ë„ì „í•´ë³´ì„¸ìš”!",
      "ê±´ê°•í•œ ë©”ë‰´ë¥¼ ì„ íƒí•´ë³´ì„¸ìš”!",
      "ë§¤ìš´ ë§›ì— ë„ì „í•´ë³´ì„¸ìš”!",
      "ì¼ì‹ì„ ë§›ë³´ì„¸ìš”!"
    ];
    dailyChallenge = {
      date: today,
      challenge: challenges[Math.floor(Math.random() * challenges.length)],
      completed: false
    };
    localStorage.setItem('dailyChallenge', JSON.stringify(dailyChallenge));
  }
  document.getElementById('challengeText').textContent = dailyChallenge.challenge;
}

// ì¼ì¼ ì±Œë¦°ì§€ ì‹œì‘
function startDailyChallenge() {
  const challengeFilter = dailyChallenge.challenge.includes('í•œì‹') ? 'í•œì‹' :
                         dailyChallenge.challenge.includes('ì–‘ì‹') ? 'ì–‘ì‹' :
                         dailyChallenge.challenge.includes('ê±´ê°•') ? 'ê±´ê°•ì‹' :
                         dailyChallenge.challenge.includes('ë§¤ìš´') ? 'ë§¤ìš´ë§›' :
                         dailyChallenge.challenge.includes('ì¼ì‹') ? 'ì¼ì‹' : null;
  
  if (challengeFilter) {
    document.querySelector(`input[value="${challengeFilter}"]`).checked = true;
  }
  startRoulette();
}

// ë©”ë‰´ í‰ì 
function rateMenu(rating) {
  if (!finalMenu) return;
  
  userRatings[finalMenu.name] = rating;
  localStorage.setItem('menuRatings', JSON.stringify(userRatings));
  
  // ë³„í‘œ í‘œì‹œ ì—…ë°ì´íŠ¸
  const stars = document.querySelectorAll('.rating .star');
  stars.forEach((star, index) => {
    star.classList.toggle('active', index < rating);
  });
  
  document.getElementById('ratingText').textContent = `í‰ì : ${rating}/5 - ${getRatingText(rating)}`;
  updateLeaderboard();
}

// í‰ì  í…ìŠ¤íŠ¸
function getRatingText(rating) {
  const texts = ['ë³„ë¡œì˜ˆìš”', 'ê·¸ì € ê·¸ë˜ìš”', 'ê´œì°®ì•„ìš”', 'ì¢‹ì•„ìš”', 'ìµœê³ ì˜ˆìš”'];
  return texts[rating - 1] || '';
}

// ì¦ê²¨ì°¾ê¸° í† ê¸€
function toggleFavorite() {
  if (!finalMenu) return;
  
  const index = favorites.indexOf(finalMenu.name);
  if (index > -1) {
    favorites.splice(index, 1);
    document.getElementById('favoriteBtn').textContent = 'ğŸ¤ ì¦ê²¨ì°¾ê¸°';
  } else {
    favorites.push(finalMenu.name);
    document.getElementById('favoriteBtn').textContent = 'â¤ï¸ ì¦ê²¨ì°¾ê¸°ë¨';
  }
  
  localStorage.setItem('favorites', JSON.stringify(favorites));
}

// ë¦¬ë”ë³´ë“œ ì—…ë°ì´íŠ¸
function updateLeaderboard() {
  const menuStats = {};
  menus.forEach(menu => {
    const rating = userRatings[menu.name] || 0;
    menuStats[menu.name] = rating;
  });
  
  const sortedMenus = Object.entries(menuStats)
    .sort(([,a], [,b]) => b - a)
    .slice(0, 5);
  
  const leaderboardList = document.getElementById('leaderboardList');
  leaderboardList.innerHTML = sortedMenus.map(([name, rating], index) => `
    <div class="leaderboard-item">
      <span class="rank">${index + 1}ìœ„</span>
      <span>${name}</span>
      <span>â­ ${rating || 'í‰ê°€ì—†ìŒ'}</span>
    </div>
  `).join('');
}
function startRoulette() {
  const selectedFilter = document.querySelector('.filter-card input[name="filter"]:checked')?.value;

  // ë¡¤ë ›ì— ëŒì•„ê°ˆ ë°°ì—´: ëª¨ë“  ë©”ë‰´ í¬í•¨ (íšŒì „ìš©)
  const rouletteArray = [];
  while(rouletteArray.length < 20){ // ì¶©ë¶„íˆ ëŒì•„ê°€ê²Œ
    rouletteArray.push(...menus);
  }

  const rouletteDiv = document.getElementById("roulette");
  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = "";
  rouletteDiv.classList.remove('final');
  document.getElementById("shareResultBtn").style.display="none";
  document.getElementById("snsButtons").style.display="none";

  let i = 0;
  const spins = 30;
  let delay = 70;

  function spin() {
    const menu = rouletteArray[i % rouletteArray.length];
    rouletteDiv.textContent = menu.name;

    rouletteDiv.classList.remove('spin');
    void rouletteDiv.offsetWidth;
    rouletteDiv.classList.add('spin');

    i++;
    delay *= 1.05;
    if(i <= spins){
      setTimeout(spin, delay);
    } else {
      // ìµœì¢… ê²°ê³¼: ì„ íƒëœ í•„í„°ì— ë§ëŠ” ë©”ë‰´ ì¤‘ ëœë¤
      let finalArray = menus;
      if(selectedFilter){
        finalArray = menus.filter(menu => menu.tags.includes(selectedFilter));
      }
      finalMenu = finalArray[Math.floor(Math.random() * finalArray.length)];

      rouletteDiv.textContent = finalMenu.name;
      rouletteDiv.classList.add('final');
      showResult(finalMenu);
    }
  }

  spin();
}





function showResult(menu){
  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = `
    <p><strong>ê±´ê°• íš¨ê³¼:</strong> ${menu.health}</p>
    <p><strong>ì¬ë£Œ:</strong> ${menu.ingredients.join(", ")}</p>
    <div class="advantages"><strong>ì¥ì :</strong> ${menu.advantages}</div>
    <div class="disadvantages"><strong>ë‹¨ì :</strong> ${menu.disadvantages}</div>
  `;
  
  // í‰ì  ì‹œìŠ¤í…œ í‘œì‹œ
  document.getElementById("rating").style.display="flex";
  document.getElementById("ratingText").style.display="block";
  document.getElementById("favoriteBtn").style.display="inline-block";
  document.getElementById("shareResultBtn").style.display="inline-block";
  document.getElementById("findRestaurantBtn").style.display="inline-block";
  document.getElementById("snsButtons").style.display="flex";

  // ê¸°ì¡´ í‰ì  í‘œì‹œ
  const existingRating = userRatings[menu.name] || 0;
  const stars = document.querySelectorAll('.rating .star');
  stars.forEach((star, index) => {
    star.classList.toggle('active', index < existingRating);
  });
  
  if (existingRating > 0) {
    document.getElementById('ratingText').textContent = `í‰ì : ${existingRating}/5 - ${getRatingText(existingRating)}`;
  } else {
    document.getElementById('ratingText').textContent = 'í‰ì ì„ ë§¤ê²¨ì£¼ì„¸ìš”!';
  }

  // ì¦ê²¨ì°¾ê¸° ìƒíƒœ í‘œì‹œ
  const isFavorite = favorites.includes(menu.name);
  document.getElementById('favoriteBtn').textContent = isFavorite ? 'â¤ï¸ ì¦ê²¨ì°¾ê¸°ë¨' : 'ğŸ¤ ì¦ê²¨ì°¾ê¸°';

  const baseUrl = window.location.origin + window.location.pathname + "?menu=" + encodeURIComponent(menu.name);
  document.getElementById("kakaoBtn").href = `https://sharer.kakao.com/talk/friends/picker/link?url=${encodeURIComponent(baseUrl)}&text=${encodeURIComponent("ì˜¤ëŠ˜ ì ì‹¬ ì¶”ì²œ: "+menu.name)}`;
  document.getElementById("facebookBtn").href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(baseUrl)}`;
  document.getElementById("twitterBtn").href = `https://twitter.com/intent/tweet?text=${encodeURIComponent("ì˜¤ëŠ˜ ì ì‹¬ ì¶”ì²œ: "+menu.name)}&url=${encodeURIComponent(baseUrl)}`;

  const url = new URL(window.location);
  url.searchParams.set('menu', menu.name);
  window.history.replaceState(null,'',url);
}

function shareResult(isResult){
  const baseUrl = window.location.origin + window.location.pathname;
  let url = baseUrl;
  let text = "ì ë©”ì¶”ë¡œ ì˜¤ëŠ˜ ì ì‹¬ ë©”ë‰´ ì¶”ì²œë°›ê¸°!";
  if(isResult && finalMenu){
    url += "?menu=" + encodeURIComponent(finalMenu.name);
    text = `ì˜¤ëŠ˜ ì ì‹¬ ì¶”ì²œ: ${finalMenu.name}\nì¥ì : ${finalMenu.advantages}\në‹¨ì : ${finalMenu.disadvantages}`;
  }

  if(navigator.share){
    navigator.share({title:"ì ë©”ì¶”", text, url}).catch(console.error);
  } else {
    window.open(url,"_blank");
  }
}

// ê·¼ì²˜ ë§›ì§‘ ì°¾ê¸°
function findNearbyRestaurants() {
  if (!finalMenu) return;
  
  // ë©”ë‰´ì— ë”°ë¥¸ ê²€ìƒ‰ í‚¤ì›Œë“œ ìƒì„±
  const searchKeywords = {
    "ê¹€ì¹˜ì°Œê°œ ğŸ²": "ê¹€ì¹˜ì°Œê°œ ë§›ì§‘",
    "ë¹„ë¹”ë°¥ ğŸ¥—": "ë¹„ë¹”ë°¥ ë§›ì§‘",
    "í”¼ì ğŸ•": "í”¼ì ë§›ì§‘",
    "ë¼ë©´ ğŸœ": "ë¼ë©´ ë§›ì§‘",
    "ìƒëŸ¬ë“œ ğŸ¥—": "ìƒëŸ¬ë“œ ë§›ì§‘",
    "ë–¡ë³¶ì´ ğŸŒ¶": "ë–¡ë³¶ì´ ë§›ì§‘",
    "ì´ˆë°¥ ğŸ£": "ì´ˆë°¥ ë§›ì§‘",
    "íŒŒìŠ¤íƒ€ ğŸ": "íŒŒìŠ¤íƒ€ ë§›ì§‘",
    "ìŠ¤í…Œì´í¬ ğŸ¥©": "ìŠ¤í…Œì´í¬ ë§›ì§‘",
    "ìƒŒë“œìœ„ì¹˜ ğŸ¥ª": "ìƒŒë“œìœ„ì¹˜ ë§›ì§‘",
    "ìš°ë™ ğŸœ": "ìš°ë™ ë§›ì§‘",
    "ì§œì¥ë©´ ğŸœ": "ì§œì¥ë©´ ë§›ì§‘",
    "íƒ•ìˆ˜ìœ¡ ğŸ¥©": "íƒ•ìˆ˜ìœ¡ ë§›ì§‘",
    "ê¹€ë°¥ ğŸ™": "ê¹€ë°¥ ë§›ì§‘",
    "ì˜¤ë¯€ë¼ì´ìŠ¤ ğŸ³": "ì˜¤ë¯€ë¼ì´ìŠ¤ ë§›ì§‘",
    "ì¹´ë ˆ ğŸ›": "ì¹´ë ˆ ë§›ì§‘",
    "ëƒ‰ë©´ ğŸ¥¢": "ëƒ‰ë©´ ë§›ì§‘",
    "ê°ˆë¹„íƒ• ğŸ²": "ê°ˆë¹„íƒ• ë§›ì§‘",
    "ë¶€ëŒ€ì°Œê°œ ğŸ²": "ë¶€ëŒ€ì°Œê°œ ë§›ì§‘",
    "ë–¡êµ­ ğŸ²": "ë–¡êµ­ ë§›ì§‘"
  };
  
  const keyword = searchKeywords[finalMenu.name] || finalMenu.name + " ë§›ì§‘";
  
  // ë„¤ì´ë²„ ì§€ë„ë¡œ ê²€ìƒ‰
  const naverUrl = `https://map.naver.com/v5/search/${encodeURIComponent(keyword)}`;
  window.open(naverUrl, '_blank');
  
  // êµ¬ê¸€ ë§µìœ¼ë¡œë„ ê²€ìƒ‰ (ë°±ì—…)
  const googleUrl = `https://www.google.com/maps/search/${encodeURIComponent(keyword)}`;
  
  // ì‚¬ìš©ìì—ê²Œ ì„ íƒ ì˜µì…˜ ì œê³µ
  if (confirm(`${finalMenu.name} ë§›ì§‘ì„ ì°¾ì•„ë“œë¦´ê²Œìš”!\n\në„¤ì´ë²„ ì§€ë„ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ì·¨ì†Œí•˜ë©´ êµ¬ê¸€ ë§µìœ¼ë¡œ ì´ë™)`)) {
    // ë„¤ì´ë²„ ì§€ë„ëŠ” ì´ë¯¸ ì—´ë¦¼
  } else {
    window.open(googleUrl, '_blank');
  }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
window.addEventListener('load', function() {
  initDailyChallenge();
  updateLeaderboard();
  
  // URLì—ì„œ ë©”ë‰´ íŒŒë¼ë¯¸í„° í™•ì¸
  const urlParams = new URLSearchParams(window.location.search);
  const menuParam = urlParams.get('menu');
  if (menuParam) {
    const menu = menus.find(m => m.name === menuParam);
    if (menu) {
      finalMenu = menu;
      showResult(menu);
    }
  }
});
</script>
</body>
</html>
